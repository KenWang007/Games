<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>ğŸ” é«˜DPIå±å¹•æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            color: #333;
        }
        .card h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #667eea;
        }
        .test-canvas {
            border: 2px solid #ddd;
            margin: 10px 0;
            display: block;
            background: white;
        }
        .info {
            padding: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 14px;
        }
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
        }
        .status.ok {
            background: #10b981;
            color: white;
        }
        .status.warning {
            background: #f59e0b;
            color: white;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            background: #10b981;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” é«˜DPIå±å¹•æµ‹è¯•</h1>
        
        <div class="card">
            <h2>ğŸ“± å±å¹•ä¿¡æ¯</h2>
            <div class="info">
                <strong>è®¾å¤‡åƒç´ æ¯” (DPR):</strong> <span id="dpr">-</span><br>
                <strong>å±å¹•å®½åº¦:</strong> <span id="width">-</span>px<br>
                <strong>å±å¹•é«˜åº¦:</strong> <span id="height">-</span>px<br>
                <strong>ç‰©ç†åƒç´ å®½åº¦:</strong> <span id="physical-width">-</span>px<br>
                <strong>ç‰©ç†åƒç´ é«˜åº¦:</strong> <span id="physical-height">-</span>px
            </div>
            <div id="dpr-status"></div>
        </div>
        
        <div class="card">
            <h2>ğŸ¨ Canvaså¯¹æ¯”æµ‹è¯•</h2>
            <p style="margin-bottom: 10px; color: #666;">ä¸‹é¢ä¸¤ä¸ªCanvasç»˜åˆ¶ç›¸åŒçš„æ–‡å­—å’Œå›¾å½¢ã€‚å·¦è¾¹æ˜¯<strong>æ ‡å‡†Canvas</strong>ï¼ˆå¯èƒ½æ¨¡ç³Šï¼‰ï¼Œå³è¾¹æ˜¯<strong>é«˜DPIä¼˜åŒ–Canvas</strong>ï¼ˆåº”è¯¥æ¸…æ™°ï¼‰ã€‚</p>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <p style="font-weight: bold; margin-bottom: 5px;">âŒ æ ‡å‡†Canvasï¼ˆæ¨¡ç³Šï¼‰</p>
                    <canvas id="canvas-normal" class="test-canvas" width="300" height="200"></canvas>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <p style="font-weight: bold; margin-bottom: 5px;">âœ… é«˜DPI Canvasï¼ˆæ¸…æ™°ï¼‰</p>
                    <canvas id="canvas-hidpi" class="test-canvas" width="300" height="200"></canvas>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>ğŸ’¡ è¯´æ˜</h2>
            <p style="line-height: 1.6; color: #666;">
                <strong>å¦‚æœä½ çœ‹åˆ°å³è¾¹çš„Canvasæ›´æ¸…æ™°ï¼š</strong><br>
                è¯´æ˜é«˜DPIä¼˜åŒ–ç”Ÿæ•ˆäº†ï¼æ¸¸æˆå·²ç»ä¿®å¤æ¨¡ç³Šé—®é¢˜ã€‚<br><br>
                <strong>å¦‚æœä¸¤ä¸ªCanvasçœ‹èµ·æ¥ä¸€æ ·æ¨¡ç³Šï¼š</strong><br>
                å¯èƒ½æ˜¯æµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼Œè¯·æ¸…é™¤ç¼“å­˜åé‡è¯•ã€‚<br><br>
                <strong>DPRå€¼è¯´æ˜ï¼š</strong><br>
                â€¢ 1.0 = æ ‡å‡†å±å¹•<br>
                â€¢ 2.0 = é«˜æ¸…å±å¹•ï¼ˆiPhone Retinaï¼‰<br>
                â€¢ 3.0 = è¶…é«˜æ¸…å±å¹•ï¼ˆå°ç±³/åä¸ºæ——èˆ°æœºï¼‰
            </p>
        </div>
        
        <div class="card">
            <a href="index.html" class="btn">æ‰“å¼€æ¸¸æˆæµ‹è¯•</a>
        </div>
    </div>
    
    <script>
        // æ˜¾ç¤ºå±å¹•ä¿¡æ¯
        const dpr = window.devicePixelRatio || 1;
        document.getElementById('dpr').textContent = dpr;
        document.getElementById('width').textContent = window.innerWidth;
        document.getElementById('height').textContent = window.innerHeight;
        document.getElementById('physical-width').textContent = Math.round(window.innerWidth * dpr);
        document.getElementById('physical-height').textContent = Math.round(window.innerHeight * dpr);
        
        // DPRçŠ¶æ€
        const dprStatus = document.getElementById('dpr-status');
        if (dpr >= 2) {
            dprStatus.innerHTML = '<span class="status ok">âœ… é«˜DPIå±å¹•æ£€æµ‹åˆ°</span><span style="color: #666; margin-left: 10px;">éœ€è¦ä¼˜åŒ–é˜²æ­¢æ¨¡ç³Š</span>';
        } else {
            dprStatus.innerHTML = '<span class="status warning">æ ‡å‡†DPIå±å¹•</span><span style="color: #666; margin-left: 10px;">ä¸éœ€è¦ç‰¹æ®Šä¼˜åŒ–</span>';
        }
        
        // ç»˜åˆ¶æµ‹è¯•å†…å®¹
        function drawTestContent(ctx, label) {
            // èƒŒæ™¯
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, 300, 200);
            
            // æ ‡é¢˜
            ctx.fillStyle = '#333';
            ctx.font = 'bold 20px Arial';
            ctx.fillText(label, 10, 30);
            
            // æµ‹è¯•æ–‡å­—ï¼ˆä¸åŒå¤§å°ï¼‰
            ctx.font = '16px Arial';
            ctx.fillText('æµ‹è¯•æ–‡å­— Test Text', 10, 60);
            
            ctx.font = '12px Arial';
            ctx.fillText('å°å­—ä½“æµ‹è¯• Small Font', 10, 85);
            
            // ç»˜åˆ¶çº¿æ¡
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(10, 100);
            ctx.lineTo(290, 100);
            ctx.stroke();
            
            // ç»˜åˆ¶åœ†å½¢
            ctx.fillStyle = '#10b981';
            ctx.beginPath();
            ctx.arc(50, 140, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // ç»˜åˆ¶çŸ©å½¢
            ctx.fillStyle = '#f59e0b';
            ctx.fillRect(90, 120, 40, 40);
            
            // ç»˜åˆ¶ä¸‰è§’å½¢
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.moveTo(160, 120);
            ctx.lineTo(180, 160);
            ctx.lineTo(140, 160);
            ctx.closePath();
            ctx.fill();
            
            // DPRä¿¡æ¯
            ctx.fillStyle = '#666';
            ctx.font = '10px Arial';
            ctx.fillText(`DPR: ${dpr}`, 10, 190);
        }
        
        // æ ‡å‡†Canvasï¼ˆä¸ä¼˜åŒ–ï¼‰
        const canvasNormal = document.getElementById('canvas-normal');
        const ctxNormal = canvasNormal.getContext('2d');
        drawTestContent(ctxNormal, 'æ ‡å‡†Canvas');
        
        // é«˜DPI Canvasï¼ˆä¼˜åŒ–ï¼‰
        const canvasHiDPI = document.getElementById('canvas-hidpi');
        const ctxHiDPI = canvasHiDPI.getContext('2d');
        
        // åº”ç”¨é«˜DPIä¼˜åŒ–
        const width = canvasHiDPI.width;
        const height = canvasHiDPI.height;
        
        canvasHiDPI.width = width * dpr;
        canvasHiDPI.height = height * dpr;
        canvasHiDPI.style.width = width + 'px';
        canvasHiDPI.style.height = height + 'px';
        
        ctxHiDPI.scale(dpr, dpr);
        ctxHiDPI.imageSmoothingEnabled = true;
        ctxHiDPI.imageSmoothingQuality = 'high';
        
        drawTestContent(ctxHiDPI, 'é«˜DPI Canvas');
    </script>
</body>
</html>

